<!DOCTYPE html>
<html>
<head>
<title>教务管理平台·新闻</title>

<meta name="viewport" content="width=device-width, initial-scale=1">
{% load static %}
<link rel="stylesheet" href="{% static 'media/css/base.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'media/css/vendor.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'media/css/flat-admin.css' %}">

<!-- Theme -->
<link rel="stylesheet" type="text/css" href="{% static 'media/css/blue-sky.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'media/css/blue.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'media/css/red.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'media/css/yellow.css' %}">
<link rel="stylesheet" href="//at.alicdn.com/t/font_1347375_rw5tk45yi4.css">
<script type='text/javascript' src="{% static 'media/js/jquery.js' %}"></script>
<script type='text/javascript' src="{% static 'media/js/vendor.js' %}"></script>
<script type='text/javascript' src="{% static 'media/js/app.js' %}"></script>

</head>
<body>
<div class="app app-default">

<aside class="app-sidebar" id="sidebar">
<div class="sidebar-header">
	<a class="sidebar-brand" href="#"><span class="highlight">教务</span>管理平台</a>
	<button type="button" class="sidebar-toggle">
	<i class="fa fa-times"></i>
	</button>
</div>
<div class="sidebar-menu">
	<ul class="sidebar-nav">
	<li class="@@menu.messaging">
		<a href="/">
		<div class="icon">
			<i class="iconfont icon-home" style="font-size: 40px"></i>
		</div>
		<div class="title">主页</div>
		</a>
	</li>
	<li class="@@menu.messaging">
		<a href="/upload/">
		<div class="icon">
			<i class="iconfont icon-upload" style="font-size: 40px"></i>
		</div>
		<div class="title">上传文件</div>
		</a>
	</li>
	<li class="@@menu.messaging">
		<a href="/Filelibrary/">
			<div class="icon">
				<i class="iconfont icon-folder" style="font-size: 40px"></i>
			</div>
			<div class="title">文件库</div>
		</a>
	</li>
	<li class="@@menu.messaging">
		<a href="/message/">
			<div class="icon">
				<i class="iconfont icon-message" style="font-size: 40px"></i>
			</div>
			<div class="title">留言</div>
		</a>
	</li>
	<li class="@@menu.messaging">
		<a href="/Mycurriculum/">
			<div class="icon">
				<i class="iconfont icon-file" style="font-size: 40px"></i>
			</div>
			<div class="title">课程表</div>
		</a>
	</li>
	<li class="@@menu.messaging">
		<a href="/notice/">
			<div class="icon">
				<i class="iconfont icon-mail" style="font-size: 40px"></i>
			</div>
			<div class="title">通知</div>
		</a>
	</li>
	<li class="active">
		<a href="/news/">
			<div class="icon">
				<i class="iconfont icon-browser" style="font-size: 40px"></i>
			</div>
			<div class="title">新闻</div>
		</a>
	</li>
	</ul>
</div>
<div class="sidebar-footer">
	<ul class="menu">
	<li>
		<a href="/" class="dropdown-toggle" data-toggle="dropdown">
		<i class="fa fa-cogs" aria-hidden="true"></i>
		</a>
	</li>
	<li><a href="#"><span class="flag-icon flag-icon-th flag-icon-squared"></span></a></li>
	</ul>
</div>
</aside>

<script type="text/ng-template" id="sidebar-dropdown.tpl.html">
<div class="dropdown-background">
	<div class="bg"></div>
</div>
<div class="dropdown-container">
	{{list}}
</div>
</script>
<div class="app-container">

		<nav class="navbar navbar-default" id="navbar">
				<div class="container-fluid">
					<div class="navbar-collapse collapse in">
					<ul class="nav navbar-nav navbar-mobile">
						<li>
						<button type="button" class="sidebar-toggle">
							<i class="fa fa-bars"></i>
						</button>
						</li>
						<li class="logo">
						<a class="navbar-brand" href="#"><span class="highlight">教务</span>管理平台</a>
						</li>
						<li>
						<button type="button" class="navbar-toggle">
							<img class="profile-img" src="">
						</button>
						</li>
					</ul>
					<ul class="nav navbar-nav navbar-right">
						{% if username == '' and is_staff == False %}
						<li><a href="/login">登陆</a></li>
						<li><a href="/register">注册</a></li>
						{% elif is_staff == True %}
						<li class="dropdown profile">
							<a href="/xadmin">{{ username }}</a>
							<div class="dropdown-menu">
								<div class="profile-info">
									<h4 class="username">{{ username }}</h4>
								</div>
								<ul class="action">
									<li>
										<a href="#">Profile</a>
									</li>
									<li>
										<a href="#"><span class="badge badge-danger pull-right">5</span>My Inbox</a>
									</li>
									<li>
										<a href="#">Setting</a>
									</li>
									<li>
										<a href="/loginout">退出登陆</a>
									</li>
								</ul>
								</div>
						</li>
			
						{% elif is_staff == False %}
						<li class="dropdown profile">
							<a href="/personinfo/">{{ username }}</a>
							<div class="dropdown-menu">
								<div class="profile-info">
									<h4 class="username">{{ username }}</h4>
								</div>
								<ul class="action">
									<li>
										<a href="#">Profile</a>
									</li>
									<li>
										<a href="#">
											<span class="badge badge-danger pull-right">5</span>My Inbox</a>
									</li>
									<li>
										<a href="#">Setting</a>
									</li>
									<li>
										<a href="/loginout">退出登陆</a>
									</li>
								</ul>
							</div>
						</li>
								
						<li class="dropdown notification">
							<a href="/news/" class="dropdown-toggle">
								<div class="icon">
									<i class="iconfont icon-browser" style="font-size: 32px"></i>
								</div>
								<div class="title">New Orders</div>
								<div class="count">{{ newcount }}</div>
							</a>
							<div class="dropdown-menu">
								<ul>
									 
									<li class="dropdown-header">最新新闻</li>
									<li class="dropdown-empty">{{ somenew.news_content }}</li>
									<li class="dropdown-footer">
										<a href="/news/">查看全部新闻</a>
									</li>
								</ul>
							</div>
						</li>
			
						<li class="dropdown notification warning">
							<a href="/notice/" class="dropdown-toggle">
								<div class="icon">
									<i class="iconfont icon-mail" style="font-size: 32px"></i>
								</div>
								<div class="title">Unread Messages</div>
								<div class="count">{{ noticecount }}</div>
							</a>
							<div class="dropdown-menu">
								<ul>
									<li class="dropdown-header">最新通知</li>
									<li>
										<a href="#">
											<div class="message">
												<div class="content">
													<div class="title">{{ somenotice.p_content }}</div>
													<div class="description">{{ somenotice.p_name }}</div>
												</div>
											</div>
										</a>
									</li>
									<li class="dropdown-footer">
										<a href="/notice/">查看所有通知</a>
									</li>
								</ul>
							</div>
						</li>
			
						<li class="dropdown notification danger">
							<a href="/message/" class="dropdown-toggle">
								<div class="icon">
									<i class="iconfont icon-message" style="font-size: 32px"></i>
								</div>
								<div class="count">{{ messageself }}</div>
							</a>
							<div class="dropdown-menu">
								<ul>
									<li class="dropdown-header">最新消息</li>
									<li>
										<a href="#">
											<div class="message">
											<div class="content">
												{% if useridtype == '0' %}
												<div class="title">{{ somemessage.s_name }}</div>
												{% else %}
												<div class="title">{{ somemessage.t_name }}</div>
												{% endif %}
												<div class="description">{{ somemessage.content }}</div>
											</div>
											</div>
										</a>
									</li>
									<li class="dropdown-footer">
										<a href="/message/">查看所有消息</a>
									</li>
								</ul>
							</div>
						</li>
							
						{% endif %}
					</ul>
					</div>
				</div>
				</nav>

<div class="btn-floating" id="help-actions">
<div class="btn-bg"></div>
<button type="button" class="btn btn-default btn-toggle">
	<i class="icon fa fa-plus"></i>
	<span class="help-text">Shortcut</span>
</button>
<div class="toggle-content">
	<ul class="actions">
	<li><a href="upload/">上传文件</a></li>
	<li><a href="#">Documentation</a></li>
	<li><a href="#">Issues</a></li>
	<li><a href="#">About</a></li>
	</ul>
</div>
</div>

<div class="row">
<div class="col-xs-12">
	<div class="card card-banner card-chart card-green no-br">
	<div class="card-header">
		<div class="card-title">
			<div class="title" style="color: #000"><span style="color:#DE0000 ">提示</span> :此模块可以浏览当前所有的新闻，如果您是管理员还可以编辑、发布、管理所有新闻。</div>
		</div>
	</div>
	<div class="card-body">
		<div class="ct-chart-sale"></div>
	</div>
	</div>
</div>
</div>
<div class="row">
		<div class="col-lg-12">
		<div class="card card-tab">
			<div class="card-header">
			<ul class="nav nav-tabs">
				<li role="tab1" class="active">
				<a href="#tab1" aria-controls="tab1" role="tab" data-toggle="tab">所有新闻</a>
				</li>
				<li role="tab2">
				<a href="#tab2" aria-controls="tab2" role="tab" data-toggle="tab">编辑新闻</a>
				</li>
				<li role="tab3">
				<a href="#tab3" aria-controls="tab3" role="tab" data-toggle="tab">新闻管理</a>
				</li>
			</ul>
			</div>
			<div class="card-body no-padding tab-content">
			<div role="tabpanel" class="tab-pane active no-padding" id="tab1">
				<div class="search-result">
				<ul class="result">
					{% for i in newsall %}
					<li>
					<div class="img">
						<img src="{{ i.news_picture.url }}"/>
					</div>
					<div class="info">
						<div class="title"><a href="#"><span class="highlight">{{ i.news_title }}</span></a></div>
						<h5 class="timeing">{{ i.news_author }}     {{ i.r_time }}</h5>
						<div class="description">{{ i.news_content }}</div>
					</div>
					</li>
					{% endfor %}
				</ul>
				</div>
			</div>
			<div role="tabpanel" class="tab-pane" id="tab2">
				<form action="/news/" method="POST" enctype="multipart/form-data">
					{% csrf_token %}
					{{new_uf.as_p}}
					<button type="submit">发布</button>
				</form>
			</div>
			<div role="tabpanel" class="tab-pane" id="tab3">
				<div class="search-result">
					<ul class="result">
					{% for i in newsall %}
					<li>
						<input type="text" value="{{ i.id }}" style="display: none;" class="displaynoneid">
						<input type="text" value="{{ i.news_picture }}" style="display: none;" class="newspictureurl">
						<div class="img">
							<img src="{{ i.news_picture.url }}"/>
						</div>
						<div class="info" style="position: relative; height: 150px;" >
							<div class="title"><a href="#"><span class="highlight">{{ i.news_title }}</span></a></div>
							<h5 class="timeing">{{ i.news_author }}     {{ i.r_time }}</h5>
							<div class="description">{{ i.news_content }}</div>
							<div class="options" style="position: absolute; right: 0px; bottom: 0px;">
								<button style="border: none; background-color: #DE0000; color: #fff; border-radius: 4px;text-align: center; padding: 2px;">删除此条新闻</button>
							</div>
						</div>
					
					
					</li>
					
					{% endfor %}
					
					</ul>
					
				</div>
				
			</div>
			</div>
		</div>
		</div>
	</div>
	</div>
	</div>
	{% if messages %}

				<ul class="messages" style="width: 300px; height: 250px; background-color: #fff;border: 1px solid #000;border-radius: 8px; position: fixed; z-index: 999; top: 350px; left: 800px; padding: 18px;">
			
				{% for message in messages %}
					
					<li {%if message.tags %} class="{{ message.tags }}"{% endif %} style="overflow: hidden; display: flex; flex-direction: column; justify-content:space-between;">
						<span style="float: left; font-size: 28px; color: #DE0000;">提示：</span>
						<div id="m_box" style="font-size: 20px; text-align: center; margin-top: 40px;">
							{{ message }}
						</div>
						<a href="/news/" style="margin:80px auto;">
							<button id="button_sure">确认</button>
						</a>
						
					</li>
			
				{% endfor %}
			
				</ul>
			
				{% endif %}
	</body>
	<script>
		$('.options').click(function(){
			newsid = $('.options').parent().siblings().filter('input:eq(0)').val()
			newimgurl ='media/'+$('.options').parent().siblings().filter('input:eq(1)').val()
			
			$.ajax({
				type: "POST",
				url: "/delnews/",
				data: {
					newsid:newsid,
					newimgurl:newimgurl,
				},
				success: function(){
					alert('此条新闻删除成功!')
					window.location.reload()
				}
			});
		})
		
	</script>
	</html>
